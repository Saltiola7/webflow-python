# This file was auto-generated by Fern from our API Definition.

from webflow import Webflow
from webflow import AsyncWebflow
import typing
from .utilities import validate_response
from webflow import TextNodeWrite
from webflow import ComponentInstanceNodePropertyOverridesWrite
from webflow import ComponentInstanceNodePropertyOverridesWritePropertyOverridesItem
from webflow.resources.components import ComponentPropertiesWritePropertiesItem


async def test_list_(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {
        "components": [
            {
                "id": "6596da6045e56dee495bcbba",
                "name": "Primary Button",
                "group": "Buttons",
                "description": "A default button component that can be used across the site",
                "readonly": True,
            },
            {
                "id": "658205daa3e8206a523b5ad4",
                "name": "Secondary Button",
                "group": "Buttons",
                "description": "A secondary button component that can be used across the site",
                "readonly": True,
            },
            {
                "id": "6258612d1ee792848f805dcf",
                "name": "Card",
                "group": "Buttons",
                "description": "A button component that can be used across the site",
                "readonly": True,
            },
            {
                "id": "68a2b1d1ee792848f805dcf",
                "name": "Nav",
                "group": "Buttons",
                "description": "A button component that can be used across the site",
                "readonly": True,
            },
        ],
        "pagination": {"limit": 20, "offset": 0, "total": 4},
    }
    expected_types: typing.Any = {
        "components": (
            "list",
            {
                0: {"id": None, "name": None, "group": None, "description": None, "readonly": None},
                1: {"id": None, "name": None, "group": None, "description": None, "readonly": None},
                2: {"id": None, "name": None, "group": None, "description": None, "readonly": None},
                3: {"id": None, "name": None, "group": None, "description": None, "readonly": None},
            },
        ),
        "pagination": {"limit": None, "offset": None, "total": None},
    }
    response = client.components.list(site_id="580e63e98c9a982ac9b8b741")
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.components.list(site_id="580e63e98c9a982ac9b8b741")
    validate_response(async_response, expected_response, expected_types)


async def test_get_content(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {
        "componentId": "69118560-d0bc-15fc-bbf8-b8fe5f6535b5",
        "nodes": [
            {
                "type": "component-instance",
                "id": "a245c12d-995b-55ee-5ec7-aa36a6cad623",
                "componentId": "nodes",
                "propertyOverrides": [{"propertyId": "7dd14c08-2e96-8d3d-2b19-b5c03642a0f0"}],
            },
            {
                "type": "component-instance",
                "id": "a245c12d-995b-55ee-5ec7-aa36a6cad627",
                "componentId": "nodes",
                "propertyOverrides": [{"propertyId": "7dd14c08-2e96-8d3d-2b19-b5c03642a0f0"}],
            },
            {
                "type": "component-instance",
                "id": "a245c12d-995b-55ee-5ec7-aa36a6cad629",
                "componentId": "nodes",
                "propertyOverrides": [{"propertyId": "7dd14c08-2e96-8d3d-2b19-b5c03642a0f0"}],
            },
            {
                "type": "component-instance",
                "id": "a245c12d-995b-55ee-5ec7-aa36a6cad631",
                "componentId": "6258612d1ee792848f805dcf",
                "propertyOverrides": [
                    {
                        "propertyId": "a245c12d-995b-55ee-5ec7-aa36a6cad633",
                        "type": "Plain Text",
                        "text": {"text": "Don't Panic!"},
                    },
                    {
                        "propertyId": "a245c12d-995b-55ee-5ec7-aa36a6cad635",
                        "type": "Rich Text",
                        "text": {"html": "<div><p>Always know where your towel is.</p></div>"},
                    },
                ],
            },
        ],
        "pagination": {"limit": 4, "offset": 0, "total": 4},
    }
    expected_types: typing.Any = {
        "componentId": None,
        "nodes": ("list", {0: "no_validate", 1: "no_validate", 2: "no_validate", 3: "no_validate"}),
        "pagination": {"limit": None, "offset": None, "total": None},
    }
    response = client.components.get_content(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
    )
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.components.get_content(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
    )
    validate_response(async_response, expected_response, expected_types)


async def test_update_content(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {"errors": ["errors"]}
    expected_types: typing.Any = {"errors": ("list", {0: None})}
    response = client.components.update_content(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
        nodes=[
            TextNodeWrite(
                node_id="a245c12d-995b-55ee-5ec7-aa36a6cad623", text="<h1>The Hitchhiker's Guide to the Galaxy</h1>"
            ),
            TextNodeWrite(
                node_id="a245c12d-995b-55ee-5ec7-aa36a6cad627",
                text="<div><h3>Don't Panic!</h3><p>Always know where your towel is.</p></div>",
            ),
            ComponentInstanceNodePropertyOverridesWrite(
                node_id="a245c12d-995b-55ee-5ec7-aa36a6cad629",
                property_overrides=[
                    ComponentInstanceNodePropertyOverridesWritePropertyOverridesItem(
                        property_id="7dd14c08-2e96-8d3d-2b19-b5c03642a0f0",
                        text="<div><h1>Time is an <em>illusion</em></h1></div>",
                    ),
                    ComponentInstanceNodePropertyOverridesWritePropertyOverridesItem(
                        property_id="7dd14c08-2e96-8d3d-2b19-b5c03642a0f1", text="Life, the Universe and Everything"
                    ),
                ],
            ),
        ],
    )
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.components.update_content(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
        nodes=[
            TextNodeWrite(
                node_id="a245c12d-995b-55ee-5ec7-aa36a6cad623", text="<h1>The Hitchhiker's Guide to the Galaxy</h1>"
            ),
            TextNodeWrite(
                node_id="a245c12d-995b-55ee-5ec7-aa36a6cad627",
                text="<div><h3>Don't Panic!</h3><p>Always know where your towel is.</p></div>",
            ),
            ComponentInstanceNodePropertyOverridesWrite(
                node_id="a245c12d-995b-55ee-5ec7-aa36a6cad629",
                property_overrides=[
                    ComponentInstanceNodePropertyOverridesWritePropertyOverridesItem(
                        property_id="7dd14c08-2e96-8d3d-2b19-b5c03642a0f0",
                        text="<div><h1>Time is an <em>illusion</em></h1></div>",
                    ),
                    ComponentInstanceNodePropertyOverridesWritePropertyOverridesItem(
                        property_id="7dd14c08-2e96-8d3d-2b19-b5c03642a0f1", text="Life, the Universe and Everything"
                    ),
                ],
            ),
        ],
    )
    validate_response(async_response, expected_response, expected_types)


async def test_get_properties(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {
        "componentId": "658205daa3e8206a523b5ad4",
        "properties": [
            {
                "propertyId": "a245c12d-995b-55ee-5ec7-aa36a6cad623",
                "type": "Plain Text",
                "label": "Title",
                "text": {"text": "The Hitchhiker's Guide to the Galaxy"},
            },
            {
                "propertyId": "a245c12d-995b-55ee-5ec7-aa36a6cad627",
                "type": "Rich Text",
                "label": "Content",
                "text": {"html": "<div><h3>Don't Panic!</h3><p>Always know where your towel is.</p></div>"},
            },
        ],
        "pagination": {"limit": 2, "offset": 0, "total": 2},
    }
    expected_types: typing.Any = {
        "componentId": None,
        "properties": (
            "list",
            {
                0: {"propertyId": None, "type": None, "label": None, "text": {"text": None}},
                1: {"propertyId": None, "type": None, "label": None, "text": {"html": None}},
            },
        ),
        "pagination": {"limit": None, "offset": None, "total": None},
    }
    response = client.components.get_properties(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
    )
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.components.get_properties(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
    )
    validate_response(async_response, expected_response, expected_types)


async def test_update_properties(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {"errors": ["errors"]}
    expected_types: typing.Any = {"errors": ("list", {0: None})}
    response = client.components.update_properties(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
        properties=[
            ComponentPropertiesWritePropertiesItem(
                property_id="a245c12d-995b-55ee-5ec7-aa36a6cad623", text="The Hitchhiker’s Guide to the Galaxy"
            ),
            ComponentPropertiesWritePropertiesItem(
                property_id="a245c12d-995b-55ee-5ec7-aa36a6cad627",
                text="<div><h3>Dont Panic!</h3><p>Always know where your towel is.</p></div>",
            ),
        ],
    )
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.components.update_properties(
        site_id="580e63e98c9a982ac9b8b741",
        component_id="8505ba55-ef72-629e-f85c-33e4b703d48b",
        locale_id="65427cf400e02b306eaa04a0",
        properties=[
            ComponentPropertiesWritePropertiesItem(
                property_id="a245c12d-995b-55ee-5ec7-aa36a6cad623", text="The Hitchhiker’s Guide to the Galaxy"
            ),
            ComponentPropertiesWritePropertiesItem(
                property_id="a245c12d-995b-55ee-5ec7-aa36a6cad627",
                text="<div><h3>Dont Panic!</h3><p>Always know where your towel is.</p></div>",
            ),
        ],
    )
    validate_response(async_response, expected_response, expected_types)
