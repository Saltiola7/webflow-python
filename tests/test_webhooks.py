# This file was auto-generated by Fern from our API Definition.

from webflow import Webflow
from webflow import AsyncWebflow
import typing
from .utilities import validate_response
import datetime


async def test_list_(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {
        "pagination": {"limit": 100, "offset": 0, "total": 100},
        "webhooks": [
            {
                "id": "57ca0a9e418c504a6e1acbb6",
                "triggerType": "form_submission",
                "url": "https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
                "workspaceId": "4f4e46fd476ea8c507000001",
                "siteId": "562ac0395358780a1f5e6fbd",
                "filter": {"name": "Email Form"},
                "lastTriggered": "2023-02-08T23:59:28Z",
                "createdOn": "2016-09-02T23:26:22Z",
            },
            {
                "id": "578d85cce0c47cd2865f4cf2",
                "triggerType": "form_submission",
                "url": "https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
                "workspaceId": "4f4e46fd476ea8c507000001",
                "siteId": "562ac0395358780a1f5e6fbd",
                "filter": {"name": "Email Form"},
                "lastTriggered": "2023-02-08T23:59:28Z",
                "createdOn": "2016-07-19T01:43:40Z",
            },
            {
                "id": "578d85cce0c47cd2865f4cf3",
                "triggerType": "form_submission",
                "url": "https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
                "workspaceId": "4f4e46fd476ea8c507000001",
                "siteId": "562ac0395358780a1f5e6fbd",
                "filter": {"name": "Email Form"},
                "lastTriggered": "2023-02-08T23:59:28Z",
                "createdOn": "2016-07-19T01:43:40Z",
            },
        ],
    }
    expected_types: typing.Any = {
        "pagination": {"limit": None, "offset": None, "total": None},
        "webhooks": (
            "list",
            {
                0: {
                    "id": None,
                    "triggerType": None,
                    "url": None,
                    "workspaceId": None,
                    "siteId": None,
                    "filter": {"name": None},
                    "lastTriggered": "datetime",
                    "createdOn": "datetime",
                },
                1: {
                    "id": None,
                    "triggerType": None,
                    "url": None,
                    "workspaceId": None,
                    "siteId": None,
                    "filter": {"name": None},
                    "lastTriggered": "datetime",
                    "createdOn": "datetime",
                },
                2: {
                    "id": None,
                    "triggerType": None,
                    "url": None,
                    "workspaceId": None,
                    "siteId": None,
                    "filter": {"name": None},
                    "lastTriggered": "datetime",
                    "createdOn": "datetime",
                },
            },
        ),
    }
    response = client.webhooks.list(site_id="580e63e98c9a982ac9b8b741")
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.webhooks.list(site_id="580e63e98c9a982ac9b8b741")
    validate_response(async_response, expected_response, expected_types)


async def test_create(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {
        "id": "582266e0cd48de0f0e3c6d8b",
        "triggerType": "form_submission",
        "url": "https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
        "workspaceId": "4f4e46fd476ea8c507000001",
        "siteId": "562ac0395358780a1f5e6fbd",
        "filter": {"name": "My Form"},
        "lastTriggered": "2023-02-08T23:59:28Z",
        "createdOn": "2022-11-08T23:59:28Z",
    }
    expected_types: typing.Any = {
        "id": None,
        "triggerType": None,
        "url": None,
        "workspaceId": None,
        "siteId": None,
        "filter": {"name": None},
        "lastTriggered": "datetime",
        "createdOn": "datetime",
    }
    response = client.webhooks.create(
        site_id_="580e63e98c9a982ac9b8b741",
        id="582266e0cd48de0f0e3c6d8b",
        trigger_type="form_submission",
        url="https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
        workspace_id="4f4e46fd476ea8c507000001",
        site_id="562ac0395358780a1f5e6fbd",
        last_triggered=datetime.datetime.fromisoformat("2023-02-08 23:59:28+00:00"),
        created_on=datetime.datetime.fromisoformat("2022-11-08 23:59:28+00:00"),
    )
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.webhooks.create(
        site_id_="580e63e98c9a982ac9b8b741",
        id="582266e0cd48de0f0e3c6d8b",
        trigger_type="form_submission",
        url="https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
        workspace_id="4f4e46fd476ea8c507000001",
        site_id="562ac0395358780a1f5e6fbd",
        last_triggered=datetime.datetime.fromisoformat("2023-02-08 23:59:28+00:00"),
        created_on=datetime.datetime.fromisoformat("2022-11-08 23:59:28+00:00"),
    )
    validate_response(async_response, expected_response, expected_types)


async def test_get(client: Webflow, async_client: AsyncWebflow) -> None:
    expected_response: typing.Any = {
        "id": "582266e0cd48de0f0e3c6d8b",
        "triggerType": "form_submission",
        "url": "https://webhook.site/7f7f7f7f-7f7f-7f7f-7f7f-7f7f7f7f7f7f",
        "workspaceId": "4f4e46fd476ea8c507000001",
        "siteId": "562ac0395358780a1f5e6fbd",
        "filter": {"name": "My Form"},
        "lastTriggered": "2023-02-08T23:59:28Z",
        "createdOn": "2022-11-08T23:59:28Z",
    }
    expected_types: typing.Any = {
        "id": None,
        "triggerType": None,
        "url": None,
        "workspaceId": None,
        "siteId": None,
        "filter": {"name": None},
        "lastTriggered": "datetime",
        "createdOn": "datetime",
    }
    response = client.webhooks.get(webhook_id="580e64008c9a982ac9b8b754")
    validate_response(response, expected_response, expected_types)

    async_response = await async_client.webhooks.get(webhook_id="580e64008c9a982ac9b8b754")
    validate_response(async_response, expected_response, expected_types)


async def test_delete(client: Webflow, async_client: AsyncWebflow) -> None:
    # Type ignore to avoid mypy complaining about the function not being meant to return a value
    assert (
        client.webhooks.delete(webhook_id="580e64008c9a982ac9b8b754")  # type: ignore[func-returns-value]
        is None
    )

    assert (
        await async_client.webhooks.delete(webhook_id="580e64008c9a982ac9b8b754")  # type: ignore[func-returns-value]
        is None
    )
